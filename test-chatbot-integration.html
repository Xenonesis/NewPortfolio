<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chatbot Integration</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; }
        .test-container { background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .status { padding: 10px; border-radius: 5px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .response-box { background: white; padding: 15px; border-radius: 5px; margin: 10px 0; border-left: 4px solid #007bff; }
    </style>
</head>
<body>
    <h1>ü§ñ Chatbot Integration Test</h1>
    
    <div class="test-container">
        <h2>API Status Check</h2>
        <div id="api-status" class="status info">Checking API status...</div>
        <button onclick="testAPI()">Test API Connection</button>
    </div>

    <div class="test-container">
        <h2>Predefined Responses Test</h2>
        <div id="predefined-status" class="status info">Ready to test predefined responses</div>
        <button onclick="testPredefined('skills')">Test "skills"</button>
        <button onclick="testPredefined('projects')">Test "projects"</button>
        <button onclick="testPredefined('work')">Test "work"</button>
        <div id="predefined-response" class="response-box" style="display:none;"></div>
    </div>

    <div class="test-container">
        <h2>AI Response Test</h2>
        <div id="ai-status" class="status info">Ready to test AI responses</div>
        <button onclick="testAI('What technologies do you work with?')">Test AI Question</button>
        <div id="ai-response" class="response-box" style="display:none;"></div>
    </div>

    <script>
        // Simulate the chatbot's response system
        const responses = {
            "skills": "Here are some of my skills: üíª Laravel Development, PHP, Web Development, Cybersecurity, Ethical Hacking, Data Analysis.",
            "projects": "Check out my projects on GitHub: üë®‚Äçüíª https://github.com/Xenonesis.",
            "work": "I currently work as a Laravel Developer at Prarang üíº I love building web applications and working with PHP frameworks!"
        };

        async function testAPI() {
            const statusDiv = document.getElementById('api-status');
            statusDiv.textContent = 'Testing API connection...';
            statusDiv.className = 'status info';

            try {
                const apiKey = 'AIzaSyBRX1zp4FOL2V_juBXnMZes2cF6YB8xi10';
                const model = 'models/gemini-2.5-flash';
                const url = `https://generativelanguage.googleapis.com/v1beta/${model}:generateContent?key=${apiKey}`;

                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: 'Hello, can you respond with just "API Working"?' }] }],
                        generationConfig: { maxOutputTokens: 10 }
                    })
                });

                if (response.status === 429) {
                    statusDiv.textContent = '‚è∞ API quota exceeded, but connection is working! This means your API key is valid.';
                    statusDiv.className = 'status success';
                } else if (response.ok) {
                    const data = await response.json();
                    statusDiv.textContent = '‚úÖ API is working perfectly!';
                    statusDiv.className = 'status success';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                statusDiv.textContent = `‚ùå API Error: ${error.message}`;
                statusDiv.className = 'status error';
            }
        }

        function testPredefined(key) {
            const statusDiv = document.getElementById('predefined-status');
            const responseDiv = document.getElementById('predefined-response');
            
            if (responses[key]) {
                statusDiv.textContent = '‚úÖ Predefined responses working!';
                statusDiv.className = 'status success';
                responseDiv.style.display = 'block';
                responseDiv.innerHTML = `<strong>Question:</strong> ${key}<br><strong>Response:</strong> ${responses[key]}`;
            } else {
                statusDiv.textContent = '‚ùå Predefined response not found';
                statusDiv.className = 'status error';
            }
        }

        async function testAI(question) {
            const statusDiv = document.getElementById('ai-status');
            const responseDiv = document.getElementById('ai-response');
            
            statusDiv.textContent = 'Testing AI response...';
            statusDiv.className = 'status info';
            responseDiv.style.display = 'none';

            try {
                const apiKey = 'AIzaSyBRX1zp4FOL2V_juBXnMZes2cF6YB8xi10';
                const model = 'models/gemini-2.5-flash';
                const url = `https://generativelanguage.googleapis.com/v1beta/${model}:generateContent?key=${apiKey}`;

                const contextPrompt = `You are Aditya's personal portfolio chatbot. Answer questions about:
                - Skills: Laravel, PHP, JavaScript, Python, Cybersecurity, Web Development
                - Work: Laravel Developer at Prarang
                - Education: BCA in Cybersecurity from Sushant University
                - Projects: Flappy Bird game, Cinesphere movie website, Innova e-commerce site
                Keep responses concise and professional.`;

                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `${contextPrompt}\n\nUser question: ${question}` }] }],
                        generationConfig: { temperature: 0.7, maxOutputTokens: 200 }
                    })
                });

                if (response.status === 429) {
                    statusDiv.textContent = '‚è∞ API quota exceeded - but your integration is working! The chatbot will fall back to predefined responses.';
                    statusDiv.className = 'status success';
                    responseDiv.style.display = 'block';
                    responseDiv.innerHTML = `<strong>Fallback Response:</strong> I've reached my daily API limit, but I can still help with basic questions about my skills, projects, and experience!`;
                } else if (response.ok) {
                    const data = await response.json();
                    if (data.candidates && data.candidates[0].content) {
                        const aiResponse = data.candidates[0].content.parts[0].text;
                        statusDiv.textContent = '‚úÖ AI response working perfectly!';
                        statusDiv.className = 'status success';
                        responseDiv.style.display = 'block';
                        responseDiv.innerHTML = `<strong>Question:</strong> ${question}<br><strong>AI Response:</strong> ${aiResponse}`;
                    }
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                statusDiv.textContent = `‚ùå AI Error: ${error.message}`;
                statusDiv.className = 'status error';
            }
        }

        // Auto-run API test on page load
        window.onload = () => {
            testAPI();
        };
    </script>
</body>
</html>